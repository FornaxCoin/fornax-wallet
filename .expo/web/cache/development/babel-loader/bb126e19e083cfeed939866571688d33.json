{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = createStyleResolver;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _ExecutionEnvironment = require(\"fbjs/lib/ExecutionEnvironment\");\n\nvar _createCSSStyleSheet = _interopRequireDefault(require(\"./createCSSStyleSheet\"));\n\nvar _createCompileableStyle = _interopRequireDefault(require(\"./createCompileableStyle\"));\n\nvar _createOrderedCSSStyleSheet = _interopRequireDefault(require(\"./createOrderedCSSStyleSheet\"));\n\nvar _flattenArray = _interopRequireDefault(require(\"../../modules/flattenArray\"));\n\nvar _flattenStyle = _interopRequireDefault(require(\"./flattenStyle\"));\n\nvar _I18nManager = _interopRequireDefault(require(\"../I18nManager\"));\n\nvar _i18nStyle = _interopRequireDefault(require(\"./i18nStyle\"));\n\nvar _compile = require(\"./compile\");\n\nvar _initialRules = _interopRequireDefault(require(\"./initialRules\"));\n\nvar _modality = _interopRequireDefault(require(\"./modality\"));\n\nvar _constants = require(\"./constants\");\n\nfunction createStyleResolver() {\n  var inserted, sheet, cache;\n  var resolved = {\n    css: {},\n    ltr: {},\n    rtl: {},\n    rtlNoSwap: {}\n  };\n\n  var init = function init() {\n    inserted = {\n      css: {},\n      ltr: {},\n      rtl: {},\n      rtlNoSwap: {}\n    };\n    sheet = (0, _createOrderedCSSStyleSheet.default)((0, _createCSSStyleSheet.default)(_constants.STYLE_ELEMENT_ID));\n    cache = {};\n    (0, _modality.default)(function (rule) {\n      return sheet.insert(rule, _constants.STYLE_GROUPS.modality);\n    });\n\n    _initialRules.default.forEach(function (rule) {\n      sheet.insert(rule, _constants.STYLE_GROUPS.reset);\n    });\n  };\n\n  init();\n\n  function addToCache(className, prop, value) {\n    if (!cache[prop]) {\n      cache[prop] = {};\n    }\n\n    cache[prop][value] = className;\n  }\n\n  function getClassName(prop, value) {\n    var val = (0, _compile.stringifyValueWithProperty)(value, prop);\n    return cache[prop] && cache[prop].hasOwnProperty(val) && cache[prop][val];\n  }\n\n  function _injectRegisteredStyle(id) {\n    var _I18nManager$getConst = _I18nManager.default.getConstants(),\n        doLeftAndRightSwapInRTL = _I18nManager$getConst.doLeftAndRightSwapInRTL,\n        isRTL = _I18nManager$getConst.isRTL;\n\n    var dir = isRTL ? doLeftAndRightSwapInRTL ? 'rtl' : 'rtlNoSwap' : 'ltr';\n\n    if (!inserted[dir][id]) {\n      var style = (0, _createCompileableStyle.default)((0, _i18nStyle.default)((0, _flattenStyle.default)(id)));\n      var results = (0, _compile.atomic)(style);\n      Object.keys(results).forEach(function (key) {\n        var _results$key = results[key],\n            identifier = _results$key.identifier,\n            property = _results$key.property,\n            rules = _results$key.rules,\n            value = _results$key.value;\n        addToCache(identifier, property, value);\n        rules.forEach(function (rule) {\n          var group = _constants.STYLE_GROUPS.custom[property] || _constants.STYLE_GROUPS.atomic;\n          sheet.insert(rule, group);\n        });\n      });\n      inserted[dir][id] = true;\n    }\n  }\n\n  function resolve(style, classList) {\n    var nextClassList = [];\n    var props = {};\n\n    if (!style && !classList) {\n      return props;\n    }\n\n    if (Array.isArray(classList)) {\n      (0, _flattenArray.default)(classList).forEach(function (identifier) {\n        if (identifier) {\n          if (inserted.css[identifier] == null && resolved.css[identifier] != null) {\n            var item = resolved.css[identifier];\n            item.rules.forEach(function (rule) {\n              sheet.insert(rule, item.group);\n            });\n            inserted.css[identifier] = true;\n          }\n\n          nextClassList.push(identifier);\n        }\n      });\n    }\n\n    if (typeof style === 'number') {\n      _injectRegisteredStyle(style);\n\n      var key = createCacheKey(style);\n      props = _resolveStyle(style, key);\n    } else if (!Array.isArray(style)) {\n      props = _resolveStyle(style);\n    } else {\n      var flatArray = (0, _flattenArray.default)(style);\n      var isArrayOfNumbers = true;\n      var cacheKey = '';\n\n      for (var i = 0; i < flatArray.length; i++) {\n        var id = flatArray[i];\n\n        if (typeof id !== 'number') {\n          isArrayOfNumbers = false;\n        } else {\n          if (isArrayOfNumbers) {\n            cacheKey += id + '-';\n          }\n\n          _injectRegisteredStyle(id);\n        }\n      }\n\n      var _key = isArrayOfNumbers ? createCacheKey(cacheKey) : null;\n\n      props = _resolveStyle(flatArray, _key);\n    }\n\n    nextClassList.push.apply(nextClassList, (0, _toConsumableArray2.default)(props.classList));\n    var finalProps = {\n      className: classListToString(nextClassList),\n      classList: nextClassList\n    };\n\n    if (props.style) {\n      finalProps.style = props.style;\n    }\n\n    return finalProps;\n  }\n\n  function _resolveStyle(style, key) {\n    var _I18nManager$getConst2 = _I18nManager.default.getConstants(),\n        doLeftAndRightSwapInRTL = _I18nManager$getConst2.doLeftAndRightSwapInRTL,\n        isRTL = _I18nManager$getConst2.isRTL;\n\n    var dir = isRTL ? doLeftAndRightSwapInRTL ? 'rtl' : 'rtlNoSwap' : 'ltr';\n\n    if (key != null && resolved[dir][key] != null) {\n      return resolved[dir][key];\n    }\n\n    var flatStyle = (0, _flattenStyle.default)(style);\n    var localizedStyle = (0, _createCompileableStyle.default)((0, _i18nStyle.default)(flatStyle));\n    var props = Object.keys(localizedStyle).sort().reduce(function (props, styleProp) {\n      var value = localizedStyle[styleProp];\n\n      if (value != null) {\n        var className = getClassName(styleProp, value);\n\n        if (className) {\n          props.classList.push(className);\n        } else {\n          if (styleProp === 'animationKeyframes' || styleProp === 'placeholderTextColor' || styleProp === 'pointerEvents' || styleProp === 'scrollbarWidth') {\n            var a = (0, _compile.atomic)((0, _defineProperty2.default)({}, styleProp, value));\n            Object.keys(a).forEach(function (key) {\n              var _a$key = a[key],\n                  identifier = _a$key.identifier,\n                  rules = _a$key.rules;\n              props.classList.push(identifier);\n              rules.forEach(function (rule) {\n                sheet.insert(rule, _constants.STYLE_GROUPS.atomic);\n              });\n            });\n          } else {\n            if (!props.style) {\n              props.style = {};\n            }\n\n            props.style[styleProp] = value;\n          }\n        }\n      }\n\n      return props;\n    }, {\n      classList: []\n    });\n\n    if (props.style) {\n      props.style = (0, _compile.inline)(props.style);\n    }\n\n    if (key != null) {\n      resolved[dir][key] = props;\n    }\n\n    return props;\n  }\n\n  return {\n    getStyleSheet: function getStyleSheet() {\n      var textContent = sheet.getTextContent();\n\n      if (!_ExecutionEnvironment.canUseDOM) {\n        init();\n      }\n\n      return {\n        id: _constants.STYLE_ELEMENT_ID,\n        textContent: textContent\n      };\n    },\n    createCSS: function createCSS(rules, group) {\n      var result = {};\n      Object.keys(rules).forEach(function (name) {\n        var style = rules[name];\n        var compiled = (0, _compile.classic)(style, name);\n        Object.keys(compiled).forEach(function (key) {\n          var _compiled$key = compiled[key],\n              identifier = _compiled$key.identifier,\n              rules = _compiled$key.rules;\n          resolved.css[identifier] = {\n            group: group || _constants.STYLE_GROUPS.classic,\n            rules: rules\n          };\n          result[name] = identifier;\n        });\n      });\n      return result;\n    },\n    resolve: resolve,\n\n    get sheet() {\n      return sheet;\n    }\n\n  };\n}\n\nvar createCacheKey = function createCacheKey(id) {\n  var prefix = 'rn';\n  return prefix + \"-\" + id;\n};\n\nvar classListToString = function classListToString(list) {\n  return list.join(' ').trim();\n};","map":{"version":3,"sources":["D:/Project/qaim/fornax-wallet/node_modules/react-native-web/src/exports/StyleSheet/createStyleResolver.js"],"names":["createStyleResolver","inserted","sheet","cache","resolved","css","ltr","rtl","rtlNoSwap","init","STYLE_ELEMENT_ID","rule","insert","STYLE_GROUPS","modality","initialRules","forEach","reset","addToCache","className","prop","value","getClassName","val","hasOwnProperty","_injectRegisteredStyle","id","I18nManager","getConstants","doLeftAndRightSwapInRTL","isRTL","dir","style","results","Object","keys","key","identifier","property","rules","group","custom","atomic","resolve","classList","nextClassList","props","Array","isArray","item","push","createCacheKey","_resolveStyle","flatArray","isArrayOfNumbers","cacheKey","i","length","finalProps","classListToString","flatStyle","localizedStyle","sort","reduce","styleProp","a","getStyleSheet","textContent","getTextContent","canUseDOM","createCSS","result","name","compiled","classic","prefix","list","join","trim"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Nicolas Gallagher.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @noflow\n */\n\n/**\n * WARNING: changes to this file in particular can cause significant changes to\n * the results of render performance benchmarks.\n */\n\nimport { canUseDOM } from 'fbjs/lib/ExecutionEnvironment';\nimport createCSSStyleSheet from './createCSSStyleSheet';\nimport createCompileableStyle from './createCompileableStyle';\nimport createOrderedCSSStyleSheet from './createOrderedCSSStyleSheet';\nimport flattenArray from '../../modules/flattenArray';\nimport flattenStyle from './flattenStyle';\nimport I18nManager from '../I18nManager';\nimport i18nStyle from './i18nStyle';\nimport { atomic, classic, inline, stringifyValueWithProperty } from './compile';\nimport initialRules from './initialRules';\nimport modality from './modality';\nimport { STYLE_ELEMENT_ID, STYLE_GROUPS } from './constants';\n\nexport default function createStyleResolver() {\n  let inserted, sheet, cache;\n  const resolved = { css: {}, ltr: {}, rtl: {}, rtlNoSwap: {} };\n\n  const init = () => {\n    inserted = { css: {}, ltr: {}, rtl: {}, rtlNoSwap: {} };\n    sheet = createOrderedCSSStyleSheet(createCSSStyleSheet(STYLE_ELEMENT_ID));\n    cache = {};\n    modality((rule) => sheet.insert(rule, STYLE_GROUPS.modality));\n    initialRules.forEach((rule) => {\n      sheet.insert(rule, STYLE_GROUPS.reset);\n    });\n  };\n\n  init();\n\n  function addToCache(className, prop, value) {\n    if (!cache[prop]) {\n      cache[prop] = {};\n    }\n    cache[prop][value] = className;\n  }\n\n  function getClassName(prop, value) {\n    const val = stringifyValueWithProperty(value, prop);\n    return cache[prop] && cache[prop].hasOwnProperty(val) && cache[prop][val];\n  }\n\n  function _injectRegisteredStyle(id) {\n    const { doLeftAndRightSwapInRTL, isRTL } = I18nManager.getConstants();\n    const dir = isRTL ? (doLeftAndRightSwapInRTL ? 'rtl' : 'rtlNoSwap') : 'ltr';\n    if (!inserted[dir][id]) {\n      const style = createCompileableStyle(i18nStyle(flattenStyle(id)));\n      const results = atomic(style);\n      Object.keys(results).forEach((key) => {\n        const { identifier, property, rules, value } = results[key];\n        addToCache(identifier, property, value);\n        rules.forEach((rule) => {\n          const group = STYLE_GROUPS.custom[property] || STYLE_GROUPS.atomic;\n          sheet.insert(rule, group);\n        });\n      });\n      inserted[dir][id] = true;\n    }\n  }\n\n  /**\n   * Resolves a React Native style object to DOM attributes\n   */\n  function resolve(style, classList) {\n    const nextClassList = [];\n    let props = {};\n\n    if (!style && !classList) {\n      return props;\n    }\n\n    if (Array.isArray(classList)) {\n      flattenArray(classList).forEach((identifier) => {\n        if (identifier) {\n          if (inserted.css[identifier] == null && resolved.css[identifier] != null) {\n            const item = resolved.css[identifier];\n            item.rules.forEach((rule) => {\n              sheet.insert(rule, item.group);\n            });\n            inserted.css[identifier] = true;\n          }\n\n          nextClassList.push(identifier);\n        }\n      });\n    }\n\n    if (typeof style === 'number') {\n      // fast and cachable\n      _injectRegisteredStyle(style);\n      const key = createCacheKey(style);\n      props = _resolveStyle(style, key);\n    } else if (!Array.isArray(style)) {\n      // resolve a plain RN style object\n      props = _resolveStyle(style);\n    } else {\n      // flatten the style array\n      // cache resolved props when all styles are registered\n      // otherwise fallback to resolving\n      const flatArray = flattenArray(style);\n      let isArrayOfNumbers = true;\n      let cacheKey = '';\n      for (let i = 0; i < flatArray.length; i++) {\n        const id = flatArray[i];\n        if (typeof id !== 'number') {\n          isArrayOfNumbers = false;\n        } else {\n          if (isArrayOfNumbers) {\n            cacheKey += id + '-';\n          }\n          _injectRegisteredStyle(id);\n        }\n      }\n      const key = isArrayOfNumbers ? createCacheKey(cacheKey) : null;\n      props = _resolveStyle(flatArray, key);\n    }\n\n    nextClassList.push(...props.classList);\n\n    const finalProps = {\n      className: classListToString(nextClassList),\n      classList: nextClassList\n    };\n    if (props.style) {\n      finalProps.style = props.style;\n    }\n\n    return finalProps;\n  }\n\n  /**\n   * Resolves a React Native style object\n   */\n  function _resolveStyle(style, key) {\n    const { doLeftAndRightSwapInRTL, isRTL } = I18nManager.getConstants();\n    const dir = isRTL ? (doLeftAndRightSwapInRTL ? 'rtl' : 'rtlNoSwap') : 'ltr';\n\n    // faster: memoized\n    if (key != null && resolved[dir][key] != null) {\n      return resolved[dir][key];\n    }\n\n    const flatStyle = flattenStyle(style);\n    const localizedStyle = createCompileableStyle(i18nStyle(flatStyle));\n\n    // slower: convert style object to props and cache\n    const props = Object.keys(localizedStyle)\n      .sort()\n      .reduce(\n        (props, styleProp) => {\n          const value = localizedStyle[styleProp];\n          if (value != null) {\n            const className = getClassName(styleProp, value);\n            if (className) {\n              props.classList.push(className);\n            } else {\n              // Certain properties and values are not transformed by 'createReactDOMStyle' as they\n              // require more complex transforms into multiple CSS rules. Here we assume that StyleManager\n              // can bind these styles to a className, and prevent them becoming invalid inline-styles.\n              if (\n                styleProp === 'animationKeyframes' ||\n                styleProp === 'placeholderTextColor' ||\n                styleProp === 'pointerEvents' ||\n                styleProp === 'scrollbarWidth'\n              ) {\n                const a = atomic({ [styleProp]: value });\n                Object.keys(a).forEach((key) => {\n                  const { identifier, rules } = a[key];\n                  props.classList.push(identifier);\n                  rules.forEach((rule) => {\n                    sheet.insert(rule, STYLE_GROUPS.atomic);\n                  });\n                });\n              } else {\n                if (!props.style) {\n                  props.style = {};\n                }\n                // 4x slower render\n                props.style[styleProp] = value;\n              }\n            }\n          }\n          return props;\n        },\n        { classList: [] }\n      );\n\n    if (props.style) {\n      props.style = inline(props.style);\n    }\n\n    if (key != null) {\n      resolved[dir][key] = props;\n    }\n\n    return props;\n  }\n\n  return {\n    getStyleSheet() {\n      const textContent = sheet.getTextContent();\n      // Reset state on the server so critical css is always the result\n      if (!canUseDOM) {\n        init();\n      }\n\n      return {\n        id: STYLE_ELEMENT_ID,\n        textContent\n      };\n    },\n    createCSS(rules, group) {\n      const result = {};\n      Object.keys(rules).forEach((name) => {\n        const style = rules[name];\n        const compiled = classic(style, name);\n\n        Object.keys(compiled).forEach((key) => {\n          const { identifier, rules } = compiled[key];\n          resolved.css[identifier] = { group: group || STYLE_GROUPS.classic, rules };\n          result[name] = identifier;\n        });\n      });\n      return result;\n    },\n    resolve,\n    get sheet() {\n      return sheet;\n    }\n  };\n}\n\n/**\n * Misc helpers\n */\nconst createCacheKey = (id) => {\n  const prefix = 'rn';\n  return `${prefix}-${id}`;\n};\n\nconst classListToString = (list) => list.join(' ').trim();\n"]},"metadata":{},"sourceType":"script"}